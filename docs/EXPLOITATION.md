**Vulnerability Overview**



The vulnerability in this system is a misconfigured SMB file share with permissive access controls. The share allows broad user access, enabling unauthorized users to read and modify files without proper authentication or least‑privilege enforcement. This is a configuration‑based vulnerability rather than a single software flaw, so there is no specific CVE associated with it. The severity of this vulnerability is high because it allows attackers to access sensitive data, introduce malicious files, and potentially use the share as a staging point for further attacks. An attacker can discover and exploit this vulnerability by scanning the network for open SMB services and enumerating accessible shares.





**Exploitation Steps**



Reconnaissance begins by identifying open services on the target system. A network scan using nmap reveals that SMB is exposed on TCP port 445. Further enumeration confirms that the SMB service is running and accepting connections. Share enumeration tools or manual inspection can be used to identify available shares and their access permissions. Screenshots should capture the port scan results and any discovered shares indicating weak or open access.



Exploitation involves directly accessing the exposed SMB share using standard client tools. The attacker connects to the share using the target system’s IP address and the share name. Due to weak permissions, the attacker is able to list directory contents, read files, and write new files without proper authorization. This can be performed using built‑in operating system tools or penetration testing frameworks. Screenshots should show successful connection to the share, file listing, and file creation or modification. Command syntax should be documented with brief explanations to demonstrate how access was obtained.



After gaining access to the SMB share, the attacker can access sensitive data stored on the system, modify or delete existing files, and upload malicious content. The share can be used to stage payloads or scripts for later execution, potentially leading to privilege escalation or lateral movement within the network. Persistent access may be maintained by leaving malicious files or backdoors on the share. Screenshots should demonstrate unauthorized data access or file manipulation on the compromised system.





**Defensive Considerations**



Blue Team defenders can detect this attack by monitoring Windows security logs and SMB access logs for unusual or unauthorized access attempts. Indicators include unexpected connections to the file share, file modifications by unauthorized users, and access originating from unfamiliar systems. Network monitoring tools may detect SMB enumeration activity or unusual traffic patterns on port 445.



Mitigation involves correcting the insecure SMB configuration. Access controls should be tightened by applying the principle of least privilege to both NTFS and share permissions. Anonymous or overly broad access groups should be removed, and authentication should be restricted to authorized users only. 


**Exploitation Flow**


Step 1: Reconnaissance – Identify SMB Service

The attacker scans the target system to check if SMB is exposed.
Using <nmap -p 445 <target-ip>>, the scan confirms that port 445 is open, indicating the SMB service is running.



Step 2: Reconnaissance – Enumerate SMB Shares

The attacker lists available SMB shares using <smbclient -L //<target-ip> -N>.
This reveals accessible shares and shows that authentication is not required.



Step 3: Exploitation – Connect to Exposed Share

The attacker connects to the exposed file share using smbclient <//<target-ip>/NeonPublic -N>.
Due to weak permissions, access is granted without credentials.



Step 4: Exploitation – List Files

The attacker lists the contents of the share using the <ls> command, confirming read access to stored files.



Step 5: Exploitation – Download Sensitive File

The attacker downloads an existing file from the share using <get _sensitive_.txt>, demonstrating unauthorized data access.



Step 6: Exploitation – Upload Malicious 

The attacker uploads a new file using <put _malicious_.exe>, proving write access to the file share.



Step 7: Post‑Exploitation – Verify File Modification

The attacker lists the directory contents again to confirm the uploaded file exists.
